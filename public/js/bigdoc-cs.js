// Generated by CoffeeScript 1.9.0
(function() {
  var __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

  window.thecloud = null;

  window.drawfunc = null;

  window.wordsMatch = null;

  $(function() {

    /*
    	#TODO: Implement word quantity by slider
    	$('#cloudCount').slider {
    		formatter : (value) ->
    			return "abc: " + value
    		}
     */
    var connectorStr, filter_diseases, relevantStr;
    connectorStr = ['the', 'and', 'or'];
    relevantStr = ['pain', 'coughing', 'sneezing'];
    filter_diseases = function() {
      var callUrl, filtered, outString, symptoms, word, _i, _len;
      outString = $("#symptoms").val().replace(/[`~!@#$%^&*()_|+\=?;:'",.<>\{\}\[\]\\\/]/gi, ' ');
      symptoms = outString.split(/[\s,]+/);
      filtered = [];
      callUrl = 'api/diagnose?symptoms=' + outString;
      console.log(callUrl);
      $.get(callUrl, function(msg) {
        console.log(msg);
        window.wordsMatch = msg.diseases;
        generate();
        return $jsonBlock;
      }).error(function(err) {
        return console.log("Error");
      });
      for (_i = 0, _len = symptoms.length; _i < _len; _i++) {
        word = symptoms[_i];
        if (__indexOf.call(connectorStr, word) >= 0) {
          filtered.push('<span class="connector">' + word + '</span>');
        } else if (__indexOf.call(relevantStr, word) >= 0) {
          filtered.push('<span class="relevant">' + word + '</span>');
        } else {
          filtered.push(word);
        }
      }
      return $("#filtered-symptoms").html(filtered.join(','));
    };
    return $("#symptoms").keyup(function(ev) {
      return filter_diseases();
    });
  });

}).call(this);
